jQuery(function(e){e(".tips").tooltip();e("ul.order-status").on("click","a.dokan-edit-status",function(t){e(this).addClass("dokan-hide").closest("li").next("li").removeClass("dokan-hide");return!1});e("ul.order-status").on("click","a.dokan-cancel-status",function(t){e(this).closest("li").addClass("dokan-hide").prev("li").find("a.dokan-edit-status").removeClass("dokan-hide");return!1});e("form#dokan-order-status-form").on("submit",function(t){t.preventDefault();var n=e(this),r=n.closest("li");r.block({message:null,overlayCSS:{background:"#fff url("+dokan.ajax_loader+") no-repeat center",opacity:.6}});e.post(dokan.ajaxurl,n.serialize(),function(e){r.unblock();var t=r.prev();r.addClass("dokan-hide");t.find("label").replaceWith(e);t.find("a.dokan-edit-status").removeClass("dokan-hide")})});e("form#add-order-note").on("submit",function(t){t.preventDefault();if(!e("textarea#add-note-content").val())return;e("#dokan-order-notes").block({message:null,overlayCSS:{background:"#fff url("+dokan.ajax_loader+") no-repeat center",opacity:.6}});e.post(dokan.ajaxurl,e(this).serialize(),function(t){e("ul.order_notes").prepend(t);e("#dokan-order-notes").unblock();e("#add-note-content").val("")});return!1});e("#dokan-order-notes").on("click","a.delete_note",function(){var t=e(this).closest("li.note");e("#dokan-order-notes").block({message:null,overlayCSS:{background:"#fff url("+dokan.ajax_loader+") no-repeat center",opacity:.6}});var n={action:"woocommerce_delete_order_note",note_id:e(t).attr("rel"),security:e("#delete-note-security").val()};e.post(dokan.ajaxurl,n,function(n){e(t).remove();e("#dokan-order-notes").unblock()});return!1});e(".order_download_permissions").on("click","button.grant_access",function(){var t=e(this),n=e("select.grant_access_id").val();if(!n)return;e(".order_download_permissions").block({message:null,overlayCSS:{background:"#fff url("+dokan.ajax_loader+") no-repeat center",opacity:.6}});var r={action:"dokan_grant_access_to_download",product_id:n,loop:e(".order_download_permissions .panel").size(),order_id:t.data("order-id"),security:t.data("nonce")};e.post(dokan.ajaxurl,r,function(t){t?e("#accordion").append(t):alert("Could not grant access - the user may already have permission for this file or billing email is not set. Ensure the billing email is set, and the order has been saved.");e(".datepicker").datepicker();e(".order_download_permissions").unblock()});return!1});e(".order_download_permissions").on("click","button.revoke_access",function(t){t.preventDefault();var n=confirm("Are you sure you want to revoke access to this download?");if(n){var r=e(this),i=r.closest(".panel"),s=r.attr("rel").split(",")[0],o=r.attr("rel").split(",")[1];if(s>0){e(i).block({message:null,overlayCSS:{background:"#fff url("+dokan.ajax_loader+") no-repeat center",opacity:.6}});var u={action:"woocommerce_revoke_access_to_download",product_id:s,download_id:o,order_id:r.data("order-id"),security:r.data("nonce")};e.post(dokan.ajaxurl,u,function(t){e(i).fadeOut("300",function(){e(i).remove()})})}else e(i).fadeOut("300",function(){e(i).remove()})}return!1})});